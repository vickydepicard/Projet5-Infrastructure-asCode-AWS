---
- name: ğŸ” SÃ©curisation de base avec UFW et Fail2ban
  hosts: web
  become: true

  tasks:

    - name: ğŸ›  Mettre Ã  jour la liste des paquets
      apt:
        update_cache: yes

    - name: ğŸ“¦ Installer UFW et fail2ban
      apt:
        name: "{{ item }}"
        state: present
      loop:
        - ufw
        - fail2ban

    - name: ğŸ”¥ Configurer UFW pour autoriser SSH
      ufw:
        rule: allow
        name: OpenSSH

    - name: ğŸ”¥ Autoriser HTTP (port 80)
      ufw:
        rule: allow
        port: 80

    - name: ğŸ”’ Activer UFW par dÃ©faut
      ufw:
        state: enabled
        policy: deny
        logging: on

    - name: âš™ï¸ Sâ€™assurer que fail2ban est dÃ©marrÃ© et activÃ©
      service:
        name: fail2ban
        state: started
        enabled: true

